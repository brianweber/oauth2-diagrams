<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1272px" preserveAspectRatio="none" style="width:1308px;height:1272px;background:#FFFFFF;" version="1.1" viewBox="0 0 1308 1272" width="1308px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="134.0999" style="stroke:#000000;stroke-width:1.5;" width="334" x="478.5" y="468.5501"/><rect fill="none" height="100.8241" style="stroke:#000000;stroke-width:1.5;" width="401" x="891.5" y="895.4163"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="212" x2="212" y1="58.1358" y2="1214.1824"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="641" x2="641" y1="58.1358" y2="1214.1824"/><rect fill="#FFFFFF" height="219.218" style="stroke:#181818;stroke-width:1.0;" width="10" x="636" y="456.5501"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1092" x2="1092" y1="58.1358" y2="1214.1824"/><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="162" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="192.5" y="26.9659">Client</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="169" y="46.0339">https://client</text><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="152" x="565" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138" x="572" y="26.9659">Authorization Server</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="609" y="46.0339">https://as</text><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="123" x="1030.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="1037.5" y="26.9659">Resource Server</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="1061" y="46.0339">https://rs</text><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="162" y="1214.1824"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="192.5" y="1236.1484">Client</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="169" y="1255.2163">https://client</text><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="152" x="565" y="1214.1824"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138" x="572" y="1236.1484">Authorization Server</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="609" y="1255.2163">https://as</text><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="123" x="1030.5" y="1214.1824"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="1037.5" y="1236.1484">Resource Server</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="1061" y="1255.2163">https://rs</text><path d="M463,133.1069 L463,266.1069 L819,266.1069 L819,143.1069 L809,133.1069 L463,133.1069 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M809,133.1069 L809,143.1069 L819,143.1069 L809,133.1069 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="469" y="152.0039">Relevant AS Metadata:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="335" x="469" y="169.7099">"tls_client_certificate_bound_access_tokens": true / false,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="469" y="187.4159">"mtls_endpoint_aliases": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="265" x="481" y="205.122">"token_endpoint": "https://mtls.as/token", …</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="469" y="222.828">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="279" x="469" y="240.534">"token_endpoint_auth_methods_supported": [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="274" x="475" y="258.24">"tls_client_auth", "self_signed_tls_client_​auth"]</text><path d="M10,71.1358 L10,328.1358 L414,328.1358 L414,81.1358 L404,71.1358 L10,71.1358 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M404,71.1358 L404,81.1358 L414,81.1358 L404,71.1358 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="16" y="90.0328">Relevant Client Metadata:</text><ellipse cx="21.5" cy="104.0479" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="335" x="28" y="107.7389">"tls_client_certificate_bound_access_tokens": true / false,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3" x="16" y="125.4449"> </text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="274" x="16" y="143.1509">For PKI-based authentication (tls_client_auth):</text><ellipse cx="21.5" cy="157.1659" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="296" x="28" y="160.8569">"token_endpoint_auth_method": "tls_client_auth"</text><ellipse cx="21.5" cy="174.8719" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="367" x="28" y="178.5629">"tls_client_auth_subject_dn": "DC=client,DC=example,DC=net",</text><ellipse cx="21.5" cy="192.5779" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218" x="28" y="196.2689">or "tls_client_auth_san_dns": "client",</text><ellipse cx="21.5" cy="210.284" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="257" x="28" y="213.975">or "tls_client_auth_san_uri": "https://client",</text><ellipse cx="21.5" cy="227.99" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="28" y="231.681">or "tls_client_auth_san_ip": "…",</text><ellipse cx="21.5" cy="245.696" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="311" x="28" y="249.387">or "tls_client_auth_san_email": "app@example.com",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3" x="16" y="267.093"> </text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="321" x="16" y="284.799">For Self-signed certificate (self_signed_tls_client_​auth):</text><ellipse cx="21.5" cy="298.814" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="371" x="28" y="302.505">"token_endpoint_auth_method": "self_signed_tls_client_​auth",</text><ellipse cx="21.5" cy="316.5201" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="293" x="28" y="320.2111">"jwks_uri": "https://client/keys.jwks" or "jwks": {…}</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1296.5" x="5" y="355.8731"/><line style="stroke:#000000;stroke-width:1.0;" x1="5" x2="1301.5" y1="355.8731" y2="355.8731"/><line style="stroke:#000000;stroke-width:1.0;" x1="5" x2="1301.5" y1="358.8731" y2="358.8731"/><rect fill="#EEEEEE" height="25.706" style="stroke:#000000;stroke-width:2.0;" width="115" x="595.75" y="344.0201"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="98" x="601.75" y="361.9171">Token Request</text><polygon fill="#181818" points="624,452.5501,634,456.5501,624,460.5501,628,456.5501" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="212" x2="630" y1="456.5501" y2="456.5501"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="144" x="219" y="397.6231">Access Token Request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="400" x="219" y="415.3291">HTTPS (mTLS) POST https://as/token (token_endpoint), urlencoded</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="380" x="219" y="433.0351">client_id=CID-XXXX (must be included event when mTLS is used)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20" x="219" y="450.7411">&amp;…</text><path d="M478.5,468.5501 L541.5,468.5501 L541.5,478.2562 L531.5,488.2562 L478.5,488.2562 L478.5,468.5501 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="134.0999" style="stroke:#000000;stroke-width:1.5;" width="334" x="478.5" y="468.5501"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="493.5" y="483.4472">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="240" x="556.5" y="482.3091">[PKI-based authentication (tls_client_auth)]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="478.5" x2="812.5" y1="544.9622" y2="544.9622"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="285" x="483.5" y="558.7211">[Self-signed certificate (self_signed_tls_client_​auth)]</text><polygon fill="#FEFFDD" points="543.5,503.2562,738.5,503.2562,748.5,515.2562,738.5,528.2562,543.5,528.2562,533.5,515.2562,543.5,503.2562" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191" x="545.5" y="521.1532">Check client certificate using PKI</text><polygon fill="#FEFFDD" points="509.5,571.9441,772.5,571.9441,782.5,583.9441,772.5,596.9441,509.5,596.9441,499.5,583.9441,509.5,571.9441" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="259" x="511.5" y="589.8411">Check client certificate using provided JWKS</text><polygon fill="#181818" points="223,671.7681,213,675.7681,223,679.7681,219,675.7681" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="217" x2="635" y1="675.7681" y2="675.7681"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="152" x="229" y="634.5471">Access Token Response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="229" y="652.2531">HTTPS 200, JSON</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="229" y="669.9591">access_token=AT-XXXX</text><path d="M651,621.6501 L651,737.6501 L1092,737.6501 L1092,631.6501 L1082,621.6501 L651,621.6501 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1082,621.6501 L1082,631.6501 L1092,631.6501 L1082,621.6501 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="293" x="657" y="640.5471">eg. access_token is bound to the client certificate.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="262" x="657" y="658.2531">When it is a JWT, the "cnf" claim can be used:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="368" x="669" y="675.9591">"cnf": {"x5t#S256": "…"} (SHA-256 of the certificate in DER form)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3" x="657" y="693.6651"> </text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="420" x="657" y="711.3712">refresh_token (if any) SHOULD be bound to the client certificate as well</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190" x="657" y="729.0772">when the client is a public client.</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1296.5" x="5" y="764.7392"/><line style="stroke:#000000;stroke-width:1.0;" x1="5" x2="1301.5" y1="764.7392" y2="764.7392"/><line style="stroke:#000000;stroke-width:1.0;" x1="5" x2="1301.5" y1="767.7392" y2="767.7392"/><rect fill="#EEEEEE" height="25.706" style="stroke:#000000;stroke-width:2.0;" width="192" x="557.25" y="752.8862"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="175" x="563.25" y="770.7832">Protected Resource Access</text><polygon fill="#181818" points="1080,843.7103,1090,847.7103,1080,851.7103,1084,847.7103" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="212" x2="1086" y1="847.7103" y2="847.7103"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="154" x="219" y="806.4892">Authenticated Request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="365" x="219" y="824.1952">HTTPS (mTLS) GET/POST/… https://rs/api/protected_resource</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181" x="219" y="841.9012">Authorization: Bearer AT-XXXX</text><polygon fill="#FEFFDD" points="1025,860.7103,1159,860.7103,1169,872.7103,1159,885.7103,1025,885.7103,1015,872.7103,1025,860.7103" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="1027" y="878.6073">Validate access_token</text><path d="M891.5,895.4163 L958.5,895.4163 L958.5,905.1223 L948.5,915.1223 L891.5,915.1223 L891.5,895.4163 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="100.8241" style="stroke:#000000;stroke-width:1.5;" width="401" x="891.5" y="895.4163"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="906.5" y="910.3133">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="244" x="973.5" y="909.1752">[tls_client_certificate_bound_access_tokens]</text><polygon fill="#FEFFDD" points="922.5,930.1223,1261.5,930.1223,1271.5,960.1223,1261.5,991.1223,922.5,991.1223,912.5,960.1223,922.5,930.1223" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="924.5" y="948.0193">Validate client certificate eg.:</text><ellipse cx="930" cy="962.0343" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="323" x="936.5" y="965.7253">using "x5t#S256" claim of access_token (if this is a JWT)</text><ellipse cx="930" cy="979.7403" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="293" x="936.5" y="983.4313">using "x5t#S256" property of token introspection</text><polygon fill="#181818" points="223,1012.2403,213,1016.2403,223,1020.2403,219,1016.2403" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="217" x2="1091" y1="1016.2403" y2="1016.2403"/><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1296.5" x="5" y="1046.0933"/><line style="stroke:#000000;stroke-width:1.0;" x1="5" x2="1301.5" y1="1046.0933" y2="1046.0933"/><line style="stroke:#000000;stroke-width:1.0;" x1="5" x2="1301.5" y1="1049.0933" y2="1049.0933"/><rect fill="#EEEEEE" height="25.706" style="stroke:#000000;stroke-width:2.0;" width="151" x="577.75" y="1034.2403"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="134" x="583.75" y="1052.1373">Token Introspection</text><polygon fill="#181818" points="652,1107.3584,642,1111.3584,652,1115.3584,648,1111.3584" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="646" x2="1091" y1="1111.3584" y2="1111.3584"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="147" x="658" y="1087.8434">Introspection Request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="427" x="658" y="1105.5494">HTTPS POST https://as/introspect (introspection_endpoint), urlencoded</text><polygon fill="#181818" points="1080,1192.1824,1090,1196.1824,1080,1200.1824,1084,1196.1824" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="641" x2="1086" y1="1196.1824" y2="1196.1824"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="155" x="648" y="1137.2554">Introspection Response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="648" y="1154.9614">HTTPS 200, JSON</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="10" x="648" y="1172.6674">…</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="401" x="648" y="1190.3734">"cnf": {"x5t#S256": "…"} if tls_client_certificate_bound_access_tokens</text><!--MD5=[960169efdfac01c5429a997a41fd5094]
@startuml

!pragma teoz true

participant "Client\nhttps://client" as client
participant "Authorization Server\nhttps://as" as as
participant "Resource Server\nhttps://rs" as rs

note over as: Relevant AS Metadata:\n"tls_client_certificate_bound_access_tokens": true / false,\n"mtls_endpoint_aliases": {\n    "token_endpoint": "https://mtls.as/token", …\n},\n"token_endpoint_auth_methods_supported": [\n  "tls_client_auth", "self_signed_tls_client_​auth"]

&note over client: Relevant Client Metadata:\n* "tls_client_certificate_bound_access_tokens": true / false,\n\nFor PKI-based authentication (tls_client_auth):\n* "token_endpoint_auth_method": "tls_client_auth"\n* "tls_client_auth_subject_dn": "DC=client,DC=example,DC=net",\n* or "tls_client_auth_san_dns": "client",\n* or "tls_client_auth_san_uri": "https://client",\n* or "tls_client_auth_san_ip": "…",\n* or "tls_client_auth_san_email": "app@example.com",\n\nFor Self-signed certificate (self_signed_tls_client_​auth):\n* "token_endpoint_auth_method": "self_signed_tls_client_​auth",\n* "jwks_uri": "https://client/keys.jwks" or "jwks": {…}

== Token Request ==

client -> as ++ : **Access Token Request**\nHTTPS (mTLS) POST https://as/token (token_endpoint), urlencoded\nclient_id=CID-XXXX (must be included event when mTLS is used)\n&…

alt PKI-based authentication (tls_client_auth)
    hnote over as: Check client certificate using PKI
else Self-signed certificate (self_signed_tls_client_​auth)
    hnote over as: Check client certificate using provided JWKS
end

client <- - as - - : **Access Token Response**\nHTTPS 200, JSON\naccess_token=AT-XXXX

note right: eg. access_token is bound to the client certificate.\nWhen it is a JWT, the "cnf" claim can be used:\n    "cnf": {"x5t#S256": "…"} (SHA-256 of the certificate in DER form)\n\nrefresh_token (if any) SHOULD be bound to the client certificate as well\nwhen the client is a public client.

== Protected Resource Access ==

client -> rs: **Authenticated Request**\nHTTPS (mTLS) GET/POST/… https://rs/api/protected_resource\nAuthorization: Bearer AT-XXXX

hnote over rs: Validate access_token

opt tls_client_certificate_bound_access_tokens
hnote over rs: Validate client certificate eg.:\n* using "x5t#S256" claim of access_token (if this is a JWT)\n* using "x5t#S256" property of token introspection
end

rs -> client

== Token Introspection ==

rs -> as : **Introspection Request**\nHTTPS POST https://as/introspect (introspection_endpoint), urlencoded

as - -> rs: **Introspection Response**\nHTTPS 200, JSON\n…\n"cnf": {"x5t#S256": "…"} if tls_client_certificate_bound_access_tokens

@enduml

PlantUML version 1.2022.13(Sat Nov 19 14:22:17 CET 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: fr
Country: FR
--></g></svg>