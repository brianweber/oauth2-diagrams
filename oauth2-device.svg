<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1639px" preserveAspectRatio="none" style="width:1112px;height:1639px;background:#FFFFFF;" version="1.1" viewBox="0 0 1112 1639" width="1112px" zoomAndPan="magnify"><defs/><g><rect fill="#DDDDDD" height="1627.8303" style="stroke:#181818;stroke-width:0.5;" width="561" x="38" y="6"/><rect fill="none" height="1022.5563" style="stroke:#000000;stroke-width:1.5;" width="1095.5" x="8" y="483.1381"/><rect fill="none" height="85.118" style="stroke:#000000;stroke-width:1.5;" width="551" x="84.5" y="554.5501"/><rect fill="none" height="199.512" style="stroke:#000000;stroke-width:1.5;" width="1051.5" x="27" y="657.6682"/><rect fill="none" height="61.412" style="stroke:#000000;stroke-width:1.5;" width="829" x="84.5" y="903.1802"/><rect fill="none" height="435.6902" style="stroke:#000000;stroke-width:1.5;" width="628" x="310.5" y="1056.0042"/><rect fill="none" height="267.7481" style="stroke:#000000;stroke-width:1.5;" width="584" x="329.5" y="1209.9464"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="100.5" x2="100.5" y1="108.1358" y2="871.1802"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="100.5" x2="100.5" y1="871.1802" y2="899.1802"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="100.5" x2="100.5" y1="899.1802" y2="1529.6944"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="345.5" x2="345.5" y1="108.1358" y2="871.1802"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="345.5" x2="345.5" y1="871.1802" y2="899.1802"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="345.5" x2="345.5" y1="899.1802" y2="1529.6944"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="502" x2="502" y1="108.1358" y2="871.1802"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="502" x2="502" y1="871.1802" y2="899.1802"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="502" x2="502" y1="899.1802" y2="1529.6944"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="897.5" x2="897.5" y1="108.1358" y2="871.1802"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="897.5" x2="897.5" y1="871.1802" y2="899.1802"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="897.5" x2="897.5" y1="899.1802" y2="1529.6944"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1045" x2="1045" y1="108.1358" y2="871.1802"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1045" x2="1045" y1="871.1802" y2="899.1802"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1045" x2="1045" y1="899.1802" y2="1529.6944"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="42" y="84.9659">Resource Owner</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="78" y="104.0339">(User)</text><ellipse cx="100.5" cy="18.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M100.5,26.5 L100.5,53.5 M87.5,34.5 L113.5,34.5 M100.5,53.5 L87.5,68.5 M100.5,53.5 L113.5,68.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="107" x="292" y="74.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93" x="299" y="96.0339">Device (client)</text><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="186" x="409" y="55"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="172" x="416" y="76.9659">User Agent / Frontend for</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138" x="433" y="96.0339">Authorization Server</text><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="152" x="821.5" y="55"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138" x="828.5" y="76.9659">Authorization Server</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="865.5" y="96.0339">https://as</text><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="123" x="983.5" y="55"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="990.5" y="76.9659">Resource Server</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="1014" y="96.0339">https://rs</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="42" y="1604.6604">Resource Owner</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="78" y="1623.7283">(User)</text><ellipse cx="100.5" cy="1538.1944" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M100.5,1546.1944 L100.5,1573.1944 M87.5,1554.1944 L113.5,1554.1944 M100.5,1573.1944 L87.5,1588.1944 M100.5,1573.1944 L113.5,1588.1944 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="107" x="292" y="1529.6944"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93" x="299" y="1551.6604">Device (client)</text><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="186" x="409" y="1529.6944"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="172" x="416" y="1551.6604">User Agent / Frontend for</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138" x="433" y="1570.7283">Authorization Server</text><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="152" x="821.5" y="1529.6944"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138" x="828.5" y="1551.6604">Authorization Server</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="865.5" y="1570.7283">https://as</text><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="123" x="983.5" y="1529.6944"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="990.5" y="1551.6604">Resource Server</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="1014" y="1570.7283">https://rs</text><path d="M515.75,121.1358 L515.75,166.1358 L883.75,166.1358 L883.75,131.1358 L873.75,121.1358 L515.75,121.1358 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M873.75,121.1358 L873.75,131.1358 L883.75,131.1358 L873.75,121.1358 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="521.75" y="140.0328">Relevant AS Metadata:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="347" x="521.75" y="157.7389">"device_authorization_endpoint": "https://as/device_auth"</text><polygon fill="#181818" points="333.5,191.2539,343.5,195.2539,333.5,199.2539,337.5,195.2539" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="100.5" x2="339.5" y1="195.2539" y2="195.2539"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221" x="107.5" y="189.4449">Request to authorize resource access</text><polygon fill="#181818" points="885.5,311.49,895.5,315.49,885.5,319.49,889.5,315.49" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="345.5" x2="891.5" y1="315.49" y2="315.49"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="196" x="352.5" y="221.1509">Device Authorization Request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="409" x="352.5" y="238.8569">HTTPS POST https://as/device_auth (device_authorization_endpoint)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="227" x="352.5" y="256.5629">(authentication, for confidential client)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="277" x="352.5" y="274.2689">client_id=CID-XXXX (for non-confidential client)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="352.5" y="291.975">&amp;scope=scope1+scope2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20" x="352.5" y="309.681">&amp;…</text><polygon fill="#181818" points="356.5,467.1381,346.5,471.1381,356.5,475.1381,352.5,471.1381" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="350.5" x2="896.5" y1="471.1381" y2="471.1381"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="204" x="362.5" y="341.387">Device Authorization Response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="362.5" y="359.093">HTTPS 200, JSON</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="528" x="362.5" y="376.799">"device_code": "DC-XXXX", (REQUIRED, unique authorization request ID, limited duration)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="376" x="362.5" y="394.505">"user_code": "XOXO-9183", (REQUIRED, user confirmation code)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="292" x="362.5" y="412.2111">"verification_uri": "https://as/device", (REQUIRED)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="492" x="362.5" y="429.9171">"verification_uri_complete": https://as/device?user_code=XOXO-9183", (OPTIONAL)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174" x="362.5" y="447.6231">"expires_in": 600, (REQUIRED)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="213" x="362.5" y="465.3291">"interval": 5 (OPTIONAL, default is 5)</text><path d="M8,483.1381 L75,483.1381 L75,492.8441 L65,502.8441 L8,502.8441 L8,483.1381 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1022.5563" style="stroke:#000000;stroke-width:1.5;" width="1095.5" x="8" y="483.1381"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="23" y="498.0351">par</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="8" x2="1103.5" y1="1045.0042" y2="1045.0042"/><polygon fill="#181818" points="111.5,514.8441,101.5,518.8441,111.5,522.8441,107.5,518.8441" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="105.5" x2="344.5" y1="518.8441" y2="518.8441"/><path d="M350.5,517.8441 L350.5,544.8441 L674.5,544.8441 L674.5,527.8441 L664.5,517.8441 L350.5,517.8441 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M664.5,517.8441 L664.5,527.8441 L674.5,527.8441 L664.5,517.8441 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="303" x="356.5" y="536.7411">"Visit https://as/device and enter code XOXO-9183"</text><path d="M84.5,554.5501 L151.5,554.5501 L151.5,564.2562 L141.5,574.2562 L84.5,574.2562 L84.5,554.5501 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="85.118" style="stroke:#000000;stroke-width:1.5;" width="551" x="84.5" y="554.5501"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="99.5" y="569.4472">opt</text><polygon fill="#181818" points="111.5,586.2562,101.5,590.2562,111.5,594.2562,107.5,590.2562" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="105.5" x2="344.5" y1="590.2562" y2="590.2562"/><path d="M350.5,589.2562 L350.5,634.2562 L614.5,634.2562 L614.5,599.2562 L604.5,589.2562 L350.5,589.2562 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M604.5,589.2562 L604.5,599.2562 L614.5,599.2562 L604.5,589.2562 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="227" x="356.5" y="608.1532">Display link (eg. QR code, NFC, etc.) for</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="243" x="356.5" y="625.8592">https://as/device?user_code=XOXO-9183</text><path d="M27,657.6682 L90,657.6682 L90,667.3742 L80,677.3742 L27,677.3742 L27,657.6682 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="199.512" style="stroke:#000000;stroke-width:1.5;" width="1051.5" x="27" y="657.6682"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="42" y="672.5652">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="141" x="105" y="671.4271">[Non textual Verification]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="27" x2="1078.5" y1="765.7862" y2="765.7862"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="116" x="32" y="779.5452">[Textual Verification]</text><polygon fill="#FEFFDD" points="58,692.3742,143,692.3742,153,704.3742,143,717.3742,58,717.3742,48,704.3742,58,692.3742" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81" x="60" y="710.2712">Scan QR code</text><polygon fill="#181818" points="490,742.7862,500,746.7862,490,750.7862,494,746.7862" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="100.5" x2="496" y1="746.7862" y2="746.7862"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="306" x="107.5" y="740.9772">Browse to https://as/device?user_code=XOXO-9183</text><polygon fill="#181818" points="885.5,742.7862,895.5,746.7862,885.5,750.7862,889.5,746.7862" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="502" x2="891.5" y1="746.7862" y2="746.7862"/><polygon fill="#181818" points="490,807.4742,500,811.4742,490,815.4742,494,811.4742" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="100.5" x2="496" y1="811.4742" y2="811.4742"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="107.5" y="805.6651">Browse to https://as/device</text><polygon fill="#181818" points="885.5,807.4742,895.5,811.4742,885.5,815.4742,889.5,811.4742" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="502" x2="891.5" y1="811.4742" y2="811.4742"/><polygon fill="#181818" points="111.5,821.4742,101.5,825.4742,111.5,829.4742,107.5,825.4742" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="490,821.4742,500,825.4742,490,829.4742,494,825.4742" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="105.5" x2="496" y1="825.4742" y2="825.4742"/><polygon fill="#181818" points="513,821.4742,503,825.4742,513,829.4742,509,825.4742" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="885.5,821.4742,895.5,825.4742,885.5,829.4742,889.5,825.4742" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="507" x2="891.5" y1="825.4742" y2="825.4742"/><path d="M902.5,824.4742 L902.5,851.4742 L1057.5,851.4742 L1057.5,834.4742 L1047.5,824.4742 L902.5,824.4742 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1047.5,824.4742 L1047.5,834.4742 L1057.5,834.4742 L1047.5,824.4742 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="908.5" y="843.3712">Ask user for user_code</text><path d="M84.5,903.1802 L151.5,903.1802 L151.5,912.8862 L141.5,922.8862 L84.5,922.8862 L84.5,903.1802 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="61.412" style="stroke:#000000;stroke-width:1.5;" width="829" x="84.5" y="903.1802"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="99.5" y="918.0772">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="211" x="166.5" y="916.9391">[User does not already have a session]</text><polygon fill="#181818" points="111.5,952.5922,101.5,956.5922,111.5,960.5922,107.5,956.5922" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="490,952.5922,500,956.5922,490,960.5922,494,956.5922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="105.5" x2="496" y1="956.5922" y2="956.5922"/><polygon fill="#181818" points="513,952.5922,503,956.5922,513,960.5922,509,956.5922" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="885.5,952.5922,895.5,956.5922,885.5,960.5922,889.5,956.5922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="507" x2="891.5" y1="956.5922" y2="956.5922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="519" y="950.7832">Authentication</text><polygon fill="#181818" points="111.5,998.2982,101.5,1002.2982,111.5,1006.2982,107.5,1002.2982" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="490,998.2982,500,1002.2982,490,1006.2982,494,1002.2982" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="105.5" x2="496" y1="1002.2982" y2="1002.2982"/><polygon fill="#181818" points="513,998.2982,503,1002.2982,513,1006.2982,509,1002.2982" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="885.5,998.2982,895.5,1002.2982,885.5,1006.2982,889.5,1002.2982" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="507" x2="891.5" y1="1002.2982" y2="1002.2982"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="519" y="996.4892">Consent</text><path d="M902.5,983.5922 L902.5,1028.5922 L1080.5,1028.5922 L1080.5,993.5922 L1070.5,983.5922 L902.5,983.5922 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1070.5,983.5922 L1070.5,993.5922 L1080.5,993.5922 L1070.5,983.5922 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="908.5" y="1002.4892">"Do you want to authorize</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="908.5" y="1020.1952">ClientFoo to …?"</text><path d="M310.5,1056.0042 L383.5,1056.0042 L383.5,1065.7103 L373.5,1075.7103 L310.5,1075.7103 L310.5,1056.0042 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="435.6902" style="stroke:#000000;stroke-width:1.5;" width="628" x="310.5" y="1056.0042"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="325.5" y="1070.9012">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="210" x="398.5" y="1069.7631">[Authentication not pending (polling)]</text><polygon fill="#181818" points="885.5,1193.9464,895.5,1197.9464,885.5,1201.9464,889.5,1197.9464" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="345.5" x2="891.5" y1="1197.9464" y2="1197.9464"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="191" x="352.5" y="1103.6073">Device Access Token Request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249" x="352.5" y="1121.3133">HTTPS POST https://as/token, urlencoded</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="461" x="352.5" y="1139.0193">grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Adevice_code</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="352.5" y="1156.7253">&amp;device_code=DC-XXXX</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="369" x="352.5" y="1174.4313">&amp;client_id=CID-XXXX (if no client authentication method used)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20" x="352.5" y="1192.1373">&amp;…</text><path d="M329.5,1209.9464 L392.5,1209.9464 L392.5,1219.6524 L382.5,1229.6524 L329.5,1229.6524 L329.5,1209.9464 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="267.7481" style="stroke:#000000;stroke-width:1.5;" width="584" x="329.5" y="1209.9464"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="344.5" y="1224.8434">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="140" x="407.5" y="1223.7053">[Authentication pending]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="329.5" x2="913.5" y1="1317.7704" y2="1317.7704"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="155" x="334.5" y="1331.5293">[Authentication completed]</text><polygon fill="#181818" points="356.5,1294.7704,346.5,1298.7704,356.5,1302.7704,352.5,1298.7704" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="350.5" x2="896.5" y1="1298.7704" y2="1298.7704"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="199" x="362.5" y="1257.5494">Device Access Token Response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="362.5" y="1275.2554">HTTPS 400, JSON</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="297" x="362.5" y="1292.9614">"error": "authorization_pending" (or "slow_down")</text><polygon fill="#181818" points="356.5,1465.6944,346.5,1469.6944,356.5,1473.6944,352.5,1469.6944" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="350.5" x2="896.5" y1="1469.6944" y2="1469.6944"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="199" x="362.5" y="1357.6493">Device Access Token Response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="362.5" y="1375.3553">HTTPS 200, JSON</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208" x="362.5" y="1393.0614">access_token":"AT-XXXX", (opaque)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="362.5" y="1410.7674">"token_type":"bearer",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="362.5" y="1428.4734">"expires_in":3600,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="287" x="362.5" y="1446.1794">"refresh_token":"RT-XXXX", (OPTIONAL, opaque)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="362.5" y="1463.8854">"scope":"scope1 scope2"</text><!--MD5=[f2683f47514e1414963cf41045f59e5e]
@startuml

!pragma teoz true

box    
    actor "Resource Owner\n(User)" as user
    participant "Device (client)" as device
    participant "User Agent / Frontend for\nAuthorization Server" as uaas
end box
participant "Authorization Server\nhttps://as" as as
participant "Resource Server\nhttps://rs" as rs

note over as, uaas:Relevant AS Metadata:\n"device_authorization_endpoint": "https://as/device_auth"


user -> device: Request to authorize resource access

device -> as: **Device Authorization Request**\nHTTPS POST https://as/device_auth (device_authorization_endpoint)\n(authentication, for confidential client)\nclient_id=CID-XXXX (for non-confidential client)\n&scope=scope1+scope2\n&…

as - -> device: **Device Authorization Response**\nHTTPS 200, JSON\n"device_code": "DC-XXXX", (REQUIRED, unique authorization request ID, limited duration)\n"user_code": "XOXO-9183", (REQUIRED, user confirmation code)\n"verification_uri": "https://as/device", (REQUIRED)\n"verification_uri_complete": https://as/device?user_code=XOXO-9183", (OPTIONAL)\n"expires_in": 600, (REQUIRED)\n"interval": 5 (OPTIONAL, default is 5)

par

device -> user
hnote right: "Visit https://as/device and enter code XOXO-9183" 
opt
    device -> user
    rnote right: Display link (eg. QR code, NFC, etc.) for\nhttps://as/device?user_code=XOXO-9183
end

alt Non textual Verification
    hnote over user: Scan QR code
    user -> uaas: Browse to https://as/device?user_code=XOXO-9183
    & uaas -> as
else Textual Verification
    user -> uaas: Browse to https://as/device
    & uaas -> as
    user<->uaas
    & uaas<->as
    note right: Ask user for user_code
end

...

opt User does not already have a session
    user<->uaas
    & uaas<->as: Authentication
end

user<->uaas
& uaas<->as: Consent
rnote right: "Do you want to authorize\nClientFoo to …?"

else

loop Authentication not pending (polling)

device->as: **Device Access Token Request**\nHTTPS POST https://as/token, urlencoded\ngrant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Adevice_code\n&device_code=DC-XXXX\n&client_id=CID-XXXX (if no client authentication method used)\n&…

alt Authentication pending

as- ->device: **Device Access Token Response**\nHTTPS 400, JSON\n"error": "authorization_pending" (or "slow_down")

else Authentication completed

as- ->device: **Device Access Token Response**\nHTTPS 200, JSON\naccess_token":"AT-XXXX", (opaque)\n"token_type":"bearer",\n"expires_in":3600,\n"refresh_token":"RT-XXXX", (OPTIONAL, opaque)\n"scope":"scope1 scope2"

end

end

end

@enduml

PlantUML version 1.2022.13(Sat Nov 19 14:22:17 CET 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: fr
Country: FR
--></g></svg>