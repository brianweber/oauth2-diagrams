<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="948px" preserveAspectRatio="none" style="width:1176px;height:948px;background:#FFFFFF;" version="1.1" viewBox="0 0 1176 948" width="1176px" zoomAndPan="magnify"><defs/><g><rect fill="#DDDDDD" height="936.728" style="stroke:#181818;stroke-width:0.5;" width="656.5" x="213" y="6"/><rect fill="none" height="65.412" style="stroke:#000000;stroke-width:1.5;" width="298" x="8" y="224.9599"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="157" x2="157" y1="108.1358" y2="785.6103"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="157" x2="157" y1="785.6103" y2="828.5922"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="157" x2="157" y1="828.5922" y2="838.5922"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="298.5" x2="298.5" y1="108.1358" y2="785.6103"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="298.5" x2="298.5" y1="785.6103" y2="828.5922"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="298.5" x2="298.5" y1="828.5922" y2="838.5922"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="543.5" x2="543.5" y1="108.1358" y2="785.6103"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="543.5" x2="543.5" y1="785.6103" y2="828.5922"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="543.5" x2="543.5" y1="828.5922" y2="838.5922"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="772.5" x2="772.5" y1="108.1358" y2="785.6103"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="772.5" x2="772.5" y1="785.6103" y2="828.5922"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="772.5" x2="772.5" y1="828.5922" y2="838.5922"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="961.5" x2="961.5" y1="108.1358" y2="785.6103"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="961.5" x2="961.5" y1="785.6103" y2="828.5922"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="961.5" x2="961.5" y1="828.5922" y2="838.5922"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1109" x2="1109" y1="108.1358" y2="785.6103"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1109" x2="1109" y1="785.6103" y2="828.5922"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1109" x2="1109" y1="828.5922" y2="838.5922"/><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="107" y="55"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="137.5" y="76.9659">Client</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="114" y="96.0339">https://client</text><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="163" x="217" y="55"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149" x="224" y="76.9659">User Agent / Frontend</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="267.5" y="96.0339">for Client</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="485" y="84.9659">Resource Owner</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="521" y="104.0339">(User)</text><ellipse cx="543.5" cy="18.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M543.5,26.5 L543.5,53.5 M530.5,34.5 L556.5,34.5 M543.5,53.5 L530.5,68.5 M543.5,53.5 L556.5,68.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="186" x="679.5" y="55"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="172" x="686.5" y="76.9659">User Agent / Frontend for</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138" x="703.5" y="96.0339">Authorization Server</text><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="152" x="885.5" y="55"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138" x="892.5" y="76.9659">Authorization Server</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="929.5" y="96.0339">https://as</text><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="123" x="1047.5" y="55"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="1054.5" y="76.9659">Resource Server</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="1078" y="96.0339">https://rs</text><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="107" y="838.5922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="137.5" y="860.5581">Client</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="114" y="879.6261">https://client</text><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="163" x="217" y="838.5922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149" x="224" y="860.5581">User Agent / Frontend</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="267.5" y="879.6261">for Client</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="485" y="913.5581">Resource Owner</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="521" y="932.6261">(User)</text><ellipse cx="543.5" cy="847.0922" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M543.5,855.0922 L543.5,882.0922 M530.5,863.0922 L556.5,863.0922 M543.5,882.0922 L530.5,897.0922 M543.5,882.0922 L556.5,897.0922 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="186" x="679.5" y="838.5922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="172" x="686.5" y="860.5581">User Agent / Frontend for</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138" x="703.5" y="879.6261">Authorization Server</text><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="152" x="885.5" y="838.5922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138" x="892.5" y="860.5581">Authorization Server</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="929.5" y="879.6261">https://as</text><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="123" x="1047.5" y="838.5922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="1054.5" y="860.5581">Resource Server</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="1078" y="879.6261">https://rs</text><path d="M681,121.1358 L681,184.1358 L1053,184.1358 L1053,131.1358 L1043,121.1358 L681,121.1358 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1043,121.1358 L1043,131.1358 L1053,131.1358 L1043,121.1358 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="687" y="140.0328">Relevant AS Metadata:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="351" x="687" y="157.7389">"pushed_authorization_request_endpoint": "http://as/par",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="285" x="687" y="175.4449">"require_pushed_authorization_requests": false,</text><path d="M74.75,129.9888 L74.75,174.9888 L380.75,174.9888 L380.75,139.9888 L370.75,129.9888 L74.75,129.9888 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M370.75,129.9888 L370.75,139.9888 L380.75,139.9888 L370.75,129.9888 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="80.75" y="148.8859">Relevant Client Metadata:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="285" x="80.75" y="166.5919">"require_pushed_authorization_requests": false,</text><polygon fill="#181818" points="309.5,208.9599,299.5,212.9599,309.5,216.9599,305.5,212.9599" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="303.5" x2="542.5" y1="212.9599" y2="212.9599"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221" x="315.5" y="207.1509">Request to authorize resource access</text><polygon fill="#181818" points="168,208.9599,158,212.9599,168,216.9599,164,212.9599" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="162" x2="297.5" y1="212.9599" y2="212.9599"/><path d="M8,224.9599 L75,224.9599 L75,234.6659 L65,244.6659 L8,244.6659 L8,224.9599 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="65.412" style="stroke:#000000;stroke-width:1.5;" width="298" x="8" y="224.9599"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="23" y="239.8569">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="64" x="90" y="238.7188">[PKCE used]</text><polygon fill="#FEFFDD" points="39,259.6659,275,259.6659,285,271.6659,275,284.6659,39,284.6659,29,271.6659,39,259.6659" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="232" x="41" y="277.5629">Generate code_verifier, code_challenge</text><polygon fill="#181818" points="949.5,518.8441,959.5,522.8441,949.5,526.8441,953.5,522.8441" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="157" x2="955.5" y1="522.8441" y2="522.8441"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="200" x="164" y="322.2689">Pushed Authorization Request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="490" x="164" y="339.975">HTTPS POST https://as/par (pushed_authorization_request_endpoint), urlencoded</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="337" x="164" y="357.681">(client authentication, cf. token_endpoint_auth_method)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124" x="170" y="375.387">response_type=code</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="170" y="393.093">&amp;client_id=CID-XXXX</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="297" x="170" y="410.799">&amp;redirect_uri=https%3A%2F%2Fclient%2Ecallback</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="170" y="428.505">&amp;state=AS-XXXX</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="6" x="164" y="446.2111">  </text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="170" y="463.9171">&amp;scope=scope1+scope2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="275" x="170" y="481.6231">&amp;code_challenge_method=S256 (if PKCE used)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="241" x="170" y="499.3291">&amp;code_challenge=CCCCCC (if PKCE used)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20" x="170" y="517.0351">&amp;…</text><polygon fill="#181818" points="168,603.6682,158,607.6682,168,611.6682,164,607.6682" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="162" x2="960.5" y1="607.6682" y2="607.6682"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="200" x="174" y="548.7411">Pushed Authorization Request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="174" y="566.4472">HTTPS 200, JSON</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="481" x="174" y="584.1532">{"request_uri":"urn:ietf:params:oauth:request_uri:XXXXX", (single-user reference),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="174" y="601.8592">"expires_in": 60}</text><polygon fill="#181818" points="286.5,688.4923,296.5,692.4923,286.5,696.4923,290.5,692.4923" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="157" x2="292.5" y1="692.4923" y2="692.4923"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71" x="164" y="686.6833">(HTTPS 302)</text><polygon fill="#181818" points="760.5,688.4923,770.5,692.4923,760.5,696.4923,764.5,692.4923" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="298.5" x2="766.5" y1="692.4923" y2="692.4923"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="149" x="305.5" y="633.5652">Authorization Request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="357" x="305.5" y="651.2712">Redirection to GET https://as/auth (authorization_endpoint)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119" x="311.5" y="668.9772">?client_id=CID-XXXX</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="444" x="311.5" y="686.6833">&amp;request_uri=urn%3Aietf%3Aparams%3Aoauth%3Arequest_uri%3AXXXXX</text><polygon fill="#181818" points="949.5,688.4923,959.5,692.4923,949.5,696.4923,953.5,692.4923" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="772.5" x2="955.5" y1="692.4923" y2="692.4923"/><polygon fill="#FEFFDD" points="833.5,705.4923,1089.5,705.4923,1099.5,717.4923,1089.5,730.4923,833.5,730.4923,823.5,717.4923,833.5,705.4923" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="252" x="835.5" y="723.3893">Resolve request reference and invalidate it</text><polygon fill="#181818" points="783.5,773.6103,773.5,777.6103,783.5,781.6103,779.5,777.6103" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="777.5" x2="960.5" y1="777.6103" y2="777.6103"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71" x="789.5" y="771.8013">(HTTPS 302)</text><polygon fill="#181818" points="309.5,773.6103,299.5,777.6103,309.5,781.6103,305.5,777.6103" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="303.5" x2="771.5" y1="777.6103" y2="777.6103"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="149" x="315.5" y="754.0953">Authorization Request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="232" x="315.5" y="771.8013">Redirection to https://client/callback?…</text><polygon fill="#181818" points="168,773.6103,158,777.6103,168,781.6103,164,777.6103" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="162" x2="297.5" y1="777.6103" y2="777.6103"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="80" x="593" y="811.3692">end of the flow</text><!--MD5=[cbc33c018425be5f5a81947a001ccb24]
@startuml

!pragma teoz true

participant "Client\nhttps://client" as client
box
    participant "User Agent / Frontend\nfor Client" as uac
    actor "Resource Owner\n(User)" as user
    participant "User Agent / Frontend for\nAuthorization Server" as uaas
end box
participant "Authorization Server\nhttps://as" as as
participant "Resource Server\nhttps://rs" as rs

note over as, uaas:Relevant AS Metadata:\n"pushed_authorization_request_endpoint": "http://as/par",\n"require_pushed_authorization_requests": false,

& note over client, uac:Relevant Client Metadata:\n"require_pushed_authorization_requests": false,

user -> uac: Request to authorize resource access
& uac -> client

opt PKCE used
  hnote over client: Generate code_verifier, code_challenge
end

client -> as: **Pushed Authorization Request**\nHTTPS POST https://as/par (pushed_authorization_request_endpoint), urlencoded\n(client authentication, cf. token_endpoint_auth_method)\n  response_type=code\n  &client_id=CID-XXXX\n  &redirect_uri=https%3A%2F%2Fclient%2Ecallback\n  &state=AS-XXXX\n  \n  &scope=scope1+scope2\n  &code_challenge_method=S256 (if PKCE used)\n  &code_challenge=CCCCCC (if PKCE used)\n  &…

as - -> client: **Pushed Authorization Request**\nHTTPS 200, JSON\n{"request_uri":"urn:ietf:params:oauth:request_uri:XXXXX", (single-user reference),\n"expires_in": 60}

client -> uac : (HTTPS 302)
& uac -> uaas: **Authorization Request**\nRedirection to GET https://as/auth (authorization_endpoint)\n  ?client_id=CID-XXXX\n  &request_uri=urn%3Aietf%3Aparams%3Aoauth%3Arequest_uri%3AXXXXX  
& uaas -> as

hnote over as: Resolve request reference and invalidate it

as -> uaas: (HTTPS 302)
& uaas -> uac: **Authorization Request**\nRedirection to https://client/callback?…
& uac -> client

... end of the flow ...

@enduml

PlantUML version 1.2022.13(Sat Nov 19 14:22:17 CET 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: fr
Country: FR
--></g></svg>