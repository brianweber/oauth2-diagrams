<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="465px" preserveAspectRatio="none" style="width:830px;height:465px;background:#FFFFFF;" version="1.1" viewBox="0 0 830 465" width="830px" zoomAndPan="magnify"><defs/><g><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="136" x2="136" y1="58.1358" y2="407.7261"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="748" x2="748" y1="58.1358" y2="407.7261"/><rect fill="#FFFFFF" height="208.7662" style="stroke:#181818;stroke-width:1.0;" width="10" x="743" y="145.2539"/><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="86" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="116.5" y="26.9659">Client</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="93" y="46.0339">https://client</text><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="152" x="672" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138" x="679" y="26.9659">Authorization Server</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="716" y="46.0339">https://as</text><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="86" y="407.7261"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="116.5" y="429.692">Client</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="93" y="448.7599">https://client</text><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="152" x="672" y="407.7261"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138" x="679" y="429.692">Authorization Server</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="716" y="448.7599">https://as</text><path d="M32,71.1358 L32,98.1358 L240,98.1358 L240,81.1358 L230,71.1358 L32,71.1358 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M230,71.1358 L230,81.1358 L240,81.1358 L230,71.1358 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187" x="38" y="90.0328">Discovery for issuer "https://as"</text><polygon fill="#181818" points="731,141.2539,741,145.2539,731,149.2539,735,145.2539" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="136" x2="737" y1="145.2539" y2="145.2539"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="261" x="143" y="121.7389">Authorization Server Metadata Request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="369" x="143" y="139.4449">HTTPS GET https://as/.well-known/oauth-authorization-server</text><polygon fill="#181818" points="147,350.0201,137,354.0201,147,358.0201,143,354.0201" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="141" x2="742" y1="354.0201" y2="354.0201"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="269" x="153" y="171.1509">Authorization Server Metadata Response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121" x="153" y="188.8569">HTTPS 200 OK, JSON</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="153" y="206.5629">"issuer": "https://as",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229" x="153" y="224.2689">"response_types_supported": ["code"],</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="262" x="153" y="241.975">"authorization_endpoint": "https://as/auth",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="223" x="153" y="259.681">"token_endpoint": "https://as/token",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="545" x="153" y="277.387">"token_endpoint_auth_methods_supported": ["client_secret_basic", "client_secret_post", …],</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="441" x="153" y="295.093">"token_endpoint_auth_signing_alg_values_supported": ["RS256", "ES256"],</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="583" x="153" y="312.799">"grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:device_code"],</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="404" x="153" y="330.505">"code_challenge_methods_supported": ["S256"], (if PKCE supported)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="10" x="153" y="348.2111">…</text><polygon fill="#FEFFDD" points="20,367.0201,252,367.0201,262,379.0201,252,392.0201,20,392.0201,10,379.0201,20,367.0201" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="228" x="22" y="384.9171">Check issuer match with expected one</text><!--MD5=[13aa8b42a57d4407c23ad38c3bef436d]
@startuml

!pragma teoz true

participant "Client\nhttps://client" as client
participant "Authorization Server\nhttps://as" as as

note over client: Discovery for issuer "https://as"

client -> as ++ : **Authorization Server Metadata Request**\nHTTPS GET https://as/.well-known/oauth-authorization-server

as - -> client - - : **Authorization Server Metadata Response**\nHTTPS 200 OK, JSON\n"issuer": "https://as",\n"response_types_supported": ["code"],\n"authorization_endpoint": "https://as/auth",\n"token_endpoint": "https://as/token",\n"token_endpoint_auth_methods_supported": ["client_secret_basic", "client_secret_post", …],\n"token_endpoint_auth_signing_alg_values_supported": ["RS256", "ES256"],\n"grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:device_code"],\n"code_challenge_methods_supported": ["S256"], (if PKCE supported)\n…

hnote over client: Check issuer match with expected one

@enduml

PlantUML version 1.2022.13(Sat Nov 19 14:22:17 CET 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: fr
Country: FR
--></g></svg>