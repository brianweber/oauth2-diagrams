<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="463px" preserveAspectRatio="none" style="width:807px;height:463px;background:#FFFFFF;" version="1.1" viewBox="0 0 807 463" width="807px" zoomAndPan="magnify"><defs/><g><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="55" x2="55" y1="58.1358" y2="405.4321"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="592" x2="592" y1="58.1358" y2="405.4321"/><rect fill="#FFFFFF" height="209.0602" style="stroke:#181818;stroke-width:1.0;" width="10" x="587" y="178.3719"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="739.5" x2="739.5" y1="58.1358" y2="405.4321"/><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="35.5" y="26.9659">Client</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="12" y="46.0339">https://client</text><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="152" x="516" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138" x="523" y="26.9659">Authorization Server</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="560" y="46.0339">https://as</text><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="123" x="678" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="685" y="26.9659">Resource Server</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="708.5" y="46.0339">https://rs</text><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="5" y="405.4321"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="35.5" y="427.398">Client</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="12" y="446.466">https://client</text><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="152" x="516" y="405.4321"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138" x="523" y="427.398">Authorization Server</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="560" y="446.466">https://as</text><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="123" x="678" y="405.4321"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="685" y="427.398">Resource Server</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="708.5" y="446.466">https://rs</text><polygon fill="#181818" points="575,174.3719,585,178.3719,575,182.3719,579,178.3719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="55" x2="581" y1="178.3719" y2="178.3719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="152" x="62" y="84.0328">Refresh Token Request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="356" x="62" y="101.7389">HTTPS POST https://as/token (token_endpoint), urlencoded</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="412" x="62" y="119.4449">(client authentication, cf. token_endpoint_auth_methods_supported)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="230" x="62" y="137.1509">grant_type=refresh_token (REQUIRED)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="225" x="62" y="154.8569">&amp;refresh_token=RT-XXXX (REQUIRED)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147" x="62" y="172.5629">&amp;scope=foo (OPTIONAL)</text><polygon fill="#FEFFDD" points="513.5,191.3719,670.5,191.3719,680.5,212.3719,670.5,234.3719,513.5,234.3719,503.5,212.3719,513.5,191.3719" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="515.5" y="209.2689">Check refresh_token valid</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="515.5" y="226.975">and issued to this client</text><polygon fill="#181818" points="66,383.4321,56,387.4321,66,391.4321,62,387.4321" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="60" x2="586" y1="387.4321" y2="387.4321"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="160" x="72" y="257.681">Refresh Token Response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="72" y="275.387">HTTPS 200, JSON</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147" x="72" y="293.093">access_token":"AT-YYYY",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="72" y="310.799">"token_type":"bearer",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="384" x="72" y="328.505">"expires_in":3600, (RECOMMENDED, lifetime of the access_token)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="454" x="72" y="346.2111">"refresh_token":"RT-YYYY", (OPTIONAL, replaces the previous one if included)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="508" x="72" y="363.9171">"scope":"foo", (REQUIRED if different from the requested scope, OPTIONAL otherwise)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="358" x="72" y="381.6231">"id_token": "eyJ…" (when using OpenID Connect, OPTIONAL)</text><!--MD5=[c95be5cbf2726445aa7abcdf6f7ff658]
@startuml

!pragma teoz true

participant "Client\nhttps://client" as client
participant "Authorization Server\nhttps://as" as as
participant "Resource Server\nhttps://rs" as rs

client -> as ++ : **Refresh Token Request**\nHTTPS POST https://as/token (token_endpoint), urlencoded\n(client authentication, cf. token_endpoint_auth_methods_supported)\ngrant_type=refresh_token (REQUIRED)\n&refresh_token=RT-XXXX (REQUIRED)\n&scope=foo (OPTIONAL)

hnote over as: Check refresh_token valid\nand issued to this client

client <- - as - - : **Refresh Token Response**\nHTTPS 200, JSON\naccess_token":"AT-YYYY",\n"token_type":"bearer",\n"expires_in":3600, (RECOMMENDED, lifetime of the access_token)\n"refresh_token":"RT-YYYY", (OPTIONAL, replaces the previous one if included)\n"scope":"foo", (REQUIRED if different from the requested scope, OPTIONAL otherwise)\n"id_token": "eyJ…" (when using OpenID Connect, OPTIONAL)

@enduml

PlantUML version 1.2022.13(Sat Nov 19 14:22:17 CET 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: fr
Country: FR
--></g></svg>