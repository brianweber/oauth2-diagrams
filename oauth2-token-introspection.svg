<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="690px" preserveAspectRatio="none" style="width:785px;height:690px;background:#FFFFFF;" version="1.1" viewBox="0 0 785 690" width="785px" zoomAndPan="magnify"><defs/><g><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="80" x2="80" y1="58.1358" y2="632.4923"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="216" x2="216" y1="58.1358" y2="632.4923"/><rect fill="#FFFFFF" height="218.4722" style="stroke:#181818;stroke-width:1.0;" width="10" x="211" y="291.196"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="715" x2="715" y1="58.1358" y2="632.4923"/><rect fill="#FFFFFF" height="102.5301" style="stroke:#181818;stroke-width:1.0;" width="10" x="710" y="180.6659"/><rect fill="#FFFFFF" height="96.8241" style="stroke:#181818;stroke-width:1.0;" width="10" x="710" y="517.6682"/><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="30" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="60.5" y="26.9659">Client</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="37" y="46.0339">https://client</text><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="152" x="140" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138" x="147" y="26.9659">Authorization Server</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="184" y="46.0339">https://as</text><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="123" x="653.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="660.5" y="26.9659">Resource Server</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="684" y="46.0339">https://rs</text><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="30" y="632.4923"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="60.5" y="654.4582">Client</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="37" y="673.5261">https://client</text><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="152" x="140" y="632.4923"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138" x="147" y="654.4582">Authorization Server</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="184" y="673.5261">https://as</text><rect fill="#E2E2F0" height="52.1358" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="123" x="653.5" y="632.4923"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="660.5" y="654.4582">Resource Server</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="684" y="673.5261">https://rs</text><path d="M10,71.1358 L10,151.1358 L422,151.1358 L422,81.1358 L412,71.1358 L10,71.1358 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M412,71.1358 L412,81.1358 L422,81.1358 L412,71.1358 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="16" y="90.0328">Relevant AS Metadata:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="294" x="16" y="107.7389">"introspection_endpoint": "https://as/introspect",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="333" x="16" y="125.4449">"introspection_endpoint_auth_methods_supported": …,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="391" x="16" y="143.1509">"introspection_endpoint_auth_signing_alg_values_supported": …,</text><polygon fill="#181818" points="698,176.6659,708,180.6659,698,184.6659,702,180.6659" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="80" x2="704" y1="180.6659" y2="180.6659"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="154" x="87" y="174.8569">Authenticated Request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113" x="244" y="174.8569">(with access token)</text><polygon fill="#181818" points="227,279.196,217,283.196,227,287.196,223,283.196" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="221" x2="709" y1="283.196" y2="283.196"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="147" x="233" y="206.5629">Introspection Request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="427" x="233" y="224.2689">HTTPS POST https://as/introspect (introspection_endpoint), urlencoded</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="457" x="233" y="241.975">(client authentication, cf. introspection_endpoint_auth_methods_supported)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="233" y="259.681">token=AT-XXXX</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194" x="233" y="277.387">&amp;token_type_hint=access_token</text><polygon fill="#181818" points="703,505.6682,713,509.6682,703,513.6682,707,509.6682" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="221" x2="709" y1="509.6682" y2="509.6682"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="155" x="228" y="309.093">Introspection Response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="228" y="326.799">HTTPS 200, JSON</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="228" y="344.505">"active": true, (REQUIRED)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="226" x="228" y="362.2111">"scope": "scope1 scope2", (OPTIONAL)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="393" x="228" y="379.9171">"client_id": "CID-XXX", (OPTIONAL, client that requested the token)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="217" x="228" y="397.6231">"username": "john.doe", (OPTIONAL)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="211" x="228" y="415.3291">"token_type": "bearer", (OPTIONAL)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="225" x="228" y="433.0351">"exp": …, "iat": …, "nbf": …, (OPTIONAL)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="301" x="228" y="450.7411">"sub": "…", "aud": "…", "iss": "…", "jti": …, (OPTIONAL)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="437" x="228" y="468.4472">"auth_time": …, (OPTIONAL, see draft-ietf-oauth-step-up-authn-challenge)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="475" x="228" y="486.1532">"authorization_details": [{"type": "…", …}, …], (OPTIONAL, see draft-ietf-oauth-rar)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="414" x="228" y="503.8592">"txn": "TXN-XXXX" (OPTIONAL, transaction ID, see draft-ietf-oauth-rar)</text><path d="M152.25,522.6682 L152.25,602.6682 L778.25,602.6682 L778.25,532.6682 L768.25,522.6682 L152.25,522.6682 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M768.25,522.6682 L768.25,532.6682 L778.25,532.6682 L768.25,522.6682 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="308" x="307" y="541.5652">Introspection response as a JWT may be negociated</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="226" x="307" y="559.2712">(application/token-introspection+jwt):</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="299" x="307" y="576.9772">actual response in the "token_introspection" claim</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="291" x="307" y="594.6833">(see draft-ietf-oauth-jwt-introspection-response).</text><polygon fill="#181818" points="91,610.4923,81,614.4923,91,618.4923,87,614.4923" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="85" x2="709" y1="614.4923" y2="614.4923"/><!--MD5=[e35f4221d9dc4a7d9326fa80901ad18c]
@startuml

!pragma teoz true

participant "Client\nhttps://client" as client
participant "Authorization Server\nhttps://as" as as
participant "Resource Server\nhttps://rs" as rs

note over as: Relevant AS Metadata:\n"introspection_endpoint": "https://as/introspect",\n"introspection_endpoint_auth_methods_supported": …,\n"introspection_endpoint_auth_signing_alg_values_supported": …,

client -> rs: **Authenticated Request** (with access token)

activate rs

rs -> as : **Introspection Request**\nHTTPS POST https://as/introspect (introspection_endpoint), urlencoded\n(client authentication, cf. introspection_endpoint_auth_methods_supported)\ntoken=AT-XXXX\n&token_type_hint=access_token

deactivate rs
activate as

as - -> rs: **Introspection Response**\nHTTPS 200, JSON\n"active": true, (REQUIRED)\n"scope": "scope1 scope2", (OPTIONAL)\n"client_id": "CID-XXX", (OPTIONAL, client that requested the token)\n"username": "john.doe", (OPTIONAL)\n"token_type": "bearer", (OPTIONAL)\n"exp": …, "iat": …, "nbf": …, (OPTIONAL)\n"sub": "…", "aud": "…", "iss": "…", "jti": …, (OPTIONAL)\n"auth_time": …, (OPTIONAL, see draft-ietf-oauth-step-up-authn-challenge)\n"authorization_details": [{"type": "…", …}, …], (OPTIONAL, see draft-ietf-oauth-rar)\n"txn": "TXN-XXXX" (OPTIONAL, transaction ID, see draft-ietf-oauth-rar)

deactivate as
activate rs

note over as, rs: Introspection response as a JWT may be negociated\n(application/token-introspection+jwt):\nactual response in the "token_introspection" claim\n(see draft-ietf-oauth-jwt-introspection-response).

rs - -> client

deactivate rs

@enduml

PlantUML version 1.2022.13(Sat Nov 19 14:22:17 CET 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: fr
Country: FR
--></g></svg>